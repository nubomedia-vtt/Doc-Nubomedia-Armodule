ArMarkerDetector Architecture
=========================
AR filter utilizes Alvar for both marker detector and planar detection 
and provides 2D visualization with OpenCV and 3D visualization
with 3D Engine (Irrlicht, free, open source)

AR filter implementation is based on the Kurento OpenCVFilter
The basic code for the implementation is generated by Kurento.

![Architecture](https://raw.githubusercontent.com/nubomedia-vtt/armodule/master/images/armodule_relations.png)

AR filter processes video frame by frame 
    ie detects alvar markers and planar images and adds 
    visualization on them

Each frame is represented as OpenCV Mat 
        ie the basic image container

```bash
Processing of frames is done with
void ArMarkerdetectorOpenCVImpl::process (cv::Mat &mat){
â€¦
}
```

In detail the filtering steps for the process is following:
1.	a video frame as OpenCV image is passed to the AR-renderer
2.	the frame is converted to a Irrlicht image
3.	the image is rendered to the Irrlicht render target texture
4.	a 3D model is drawn to the render target texture
5.	image data is taken from the render target texture
6.	AR-renderer passes the image data back
7.	the image data is substituted to the OpenCV video frame


![Teaser](https://raw.githubusercontent.com/nubomedia-vtt/armodule/master/images/teaser.png)

Currently AR filter supports detection of 
both AlvarMarkers and planar images ie things
Visualization can be done with 2D image or 3D model

This yields total four combination that can be utilized separately or simultaneously

Mapping detected things to visualization is denoted here as Augmentables

Syntax for passing Augmentable data from Kurento Client to the ARModule is following:

id = alvarMarkerID

type = 2D or 3D

strings = array of strings that the filter utilizes eg 
	model = 2D picture or 3D model, 
	label = text over 2D picture, 
	texture = texture for 3D model of md2 format
           detect_planar = picture to be detected 
	                          for planer detection
floats = array of floats that the filter utilized eg
	  scale

An example as JSON
```bash
var augmentables = '{"augmentables":[' +
'{"id":0, "type":"2D", "strings":[{
              "model":"/opt/prope.png",
              "label":"snafu"}], 
	   "floats":[{"scale":1.0}]},' +
'{"id":3, "type":"3D", "strings":[{
	"detect_planar":"/opt/hughlaurie2.png",
 	"model":"/opt/faerie.md2", 
	"texture":"/opt/faerie2.bmp"}], 
	"floats":[{"scale":0.05}]},' +
'{"id":4, "type":"3D", "strings":[{
	"model":"/opt/teapot.ply"}], 
	"floats":[{"scale":0.5}]},' +
']}';
```

The API for Kurento Client to communicate with the 
AR filter is available at:
https://github.com/nubomedia-vtt/armodule/blob/master/ar-markerdetector/src/server/interface/armarkerdetector.ArMarkerdetector.kmd.json

//Pass augmentables 
arFilter.setArThing(Augmentables);

//Enable visualization
arFilter.enableAugmentation(true);

//Enable events for markerCount and MarkerPose 
  ie getting data back from the AR filter but separately than 
  the processed video stream
